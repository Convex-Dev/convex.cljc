;;
;;
;; Testing `convex.shell.trx`.
;;
;;


;;;;;;;;;;


(def T
     $.test)


;;;;;;;;;; Test suites


(defn suite.main

  ^{:doc {:description "Main test suite."}}

  []

  (T/group '((T/path.conj 'convex.shell.trx)

             42

             ($.trx/prepend '(def foo
                                  $/*result*))

             (T/trx '(= foo
                        42)
                    {:description "Prepends a single transaction."})

             100

             ($.trx/precat '((def foo
                                  $/*result*)
                             (def foo
                                  (inc foo))))

             (T/trx '(= 101
                        foo)
                    {:description "Prepends a list of transactions."})

             
             500

             ($.trx/set (concat '((def foo
                                       $/*result*)
                                  (def foo
                                       (inc foo)))
                                $.trx/*list*))

             (T/trx '(= 501
                        foo)
                    {:description "Emulating `precat` with `set`."}))))


;;;


(suite.main)
(T/print "convex.shell.trx")
